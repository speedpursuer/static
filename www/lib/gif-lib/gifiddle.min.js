function getFile(e,t){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.onload=function(e){t.loadBuffer(this.response)},o.send(null)}function Gifiddle(){function e(){var e=$("#viewport"),t=$("#loader-icon"),o=$("#loader-alert"),n=o.find(".alert-message");return{showLoad:function(){t.show(),e.hide(),o.hide()},showError:function(i){t.hide(),e.hide(),n.text(i),o.fadeIn()},showCanvas:function(){t.hide(),e.show(),o.slideUp()}}}var t=$("#viewport"),o=$("title").text(),n=null;return{events:new Events,loader:new e,setup:function(e){n&&n.destroy(),n=new GifPlayer(t[0],1),n.setup(e),this.events.emit("initPlayer",n),n.events.on("ready",function(){this.loader.showCanvas()}.bind(this)),n.events.on("error",function(e){this.loader.showError(e.message),console.error(e)}.bind(this)),e.completed()&&e.events.emit("load")},destroy:function(){n&&n.destroyWithGIF()},loadBuffer:function(e){n&&n.destroy(),n=new GifPlayer(t[0]),this.loader.showLoad(),this.events.emit("initPlayer",n),n.events.on("ready",function(){this.loader.showCanvas()}.bind(this)),n.events.on("error",function(e){this.loader.showError(e.message),console.error(e)}.bind(this)),n.load(e)},loadBlob:function(e){this.loader.showLoad();var t=new FileReader;t.addEventListener("load",function(e){this.loadBuffer(e.target.result)}.bind(this)),t.readAsArrayBuffer(e)},loadFile:function(e){document.title=o+": "+e.name,window.location.hash="",this.loadBlob(e)},loadUrl:function(e,t){if(0!==e.length){var n=document.createElement("a");n.href=e;var i=n.hostname;i=i.split(".").slice(-2).join(".");var r=e;t&&(r="https://cors-anywhere.herokuapp.com/"+e);var a=n.pathname.lastIndexOf("/");if(a>-1){var l=n.pathname.substring(a+1);document.title=o+": "+l}else document.title=o;window.location.hash=e;var d=new XMLHttpRequest;d.onloadstart=function(){this.loader.showLoad()}.bind(this),d.onload=function(){200===d.status?(this.url=e,this.loadBlob(d.response)):this.loader.showError("Unable to download GIF: "+new HttpStatus(d.status))}.bind(this),d.ontimeout=function(){this.loader.showError("Unable to download GIF: Connection timed out")}.bind(this),d.onerror=function(){t?this.loader.showError("Unable to download GIF: Connection failed"):this.loadUrl(e,!0)}.bind(this),d.open("GET",r,!0),d.responseType="blob",d.send()}}}}function GifiddleMenu(e){var t=$("#toolbar"),o=t.find("#toolbar-menu"),n=t.find("#toolbar-extras");$("#toolbar-controls");$(".dropdown-persistent").click(function(e){e.stopPropagation()}),function(){var t=$(".file-link"),o=$('<input type="file">');o.on("change",function(t){var o=t.target.files[0];o&&(e.loadFile(o),$("#open-file").hide())}),t.on("click",function(e){o.trigger("click")})}(),function(){var t=$("#modal-url"),o=t.find("#modal-url-form"),n=t.find("#modal-url-input");o.validator().on("submit",function(o){o.isDefaultPrevented()||(o.preventDefault(),e.loadUrl(n.val()),t.modal("hide"))})}(),function(){var t=o.find("#checkbox-render-raw"),n=o.find("#checkbox-render-bg");e.events.on("initPlayer",function(e){var o=e.getOptions();t.off(),t.on("change",function(t){e.isReady()&&o.setRenderRaw(t.target.checked)}),n.off(),n.on("change",function(t){e.isReady()&&o.setRenderBackground(t.target.checked)}),e.events.on("ready",function(){o.setRenderRaw(t.prop("checked")),o.setRenderBackground(n.prop("checked"))})})}(),function(){function t(){d.length<=1?(s=0,r.hide(),a.hide()):s>=d.length-1?(s=d.length-1,r.show(),a.hide()):0>=s?(s=0,r.hide(),a.show()):(r.show(),a.show()),d.length>0?i.text(d[s]):i.text("")}var o=n.find(".comment-link"),i=o.find(".comment-box"),r=o.find(".pager-previous"),a=o.find(".pager-next"),l=o.find(".badge"),d=[],s=0;o.hide(),r.on("click",function(){s--,t()}),a.on("click",function(){s++,t()}),e.events.on("initPlayer",function(e){e.events.on("ready",function(e){d=e.comments,s=0,0===d.length?o.fadeOut():o.fadeIn(),l.text(d.length),t()})})}()}function GifiddleControls(e){function t(e){e?(r.hide(),a.show()):(r.show(),a.hide())}function o(e){c.text(e)}var n=$("#toolbar-controls"),i=n.find("button[data-command]"),r=i.find(".icon-play"),a=i.find(".icon-pause"),l=n.find(".slider-container"),d=l.find(".range"),s=n.find(".slider-value-container"),c=s.find(".slider-value");n.hide(),t(!1),e.events.on("initPlayer",function(e){t(!1),e.events.on("play",function(){t(!0)}),e.events.on("pause",function(){t(!1)}),e.events.on("update",function(e,t){d.val(e),o(e)}),e.events.on("ready",function(){var t=e.getFrameCount();t>1&&n.fadeIn(),d.prop("min",0),d.prop("max",t-1),d.val(0),o(0)}),e.events.on("destroy",function(){n.fadeOut()}),i.off(),i.on("click",function(t){var o=t.target.dataset.command;if(!o){var n=t.target.classList[1];n.indexOf("fa-step-backward")>-1?o="setPrevious":n.indexOf("fa-step-forward")>-1?o="setNext":(n.indexOf("fa-play")>-1||n.indexOf("fa-pause")>-1)&&(o="toggle")}"toggle"!==o&&e.pause(),e[o]&&e[o]()}),d.off(),d.on("input",function(t){e.pause(),e.setFrameIndex(parseInt(t.target.value)),o(t.target.value)})})}function GifiddleUserInput(e){var t,o=$("#user-input"),n=o.find(".countdown"),i=null;o.hide(),e.events.on("initPlayer",function(e){function r(){n.text("("+t+")"),t--,t>0&&(i=setTimeout(r,1e3))}function a(){i&&(clearTimeout(i),i=null)}n.empty(),o.fadeOut(),o.off(),o.on("click",function(){e.pause(),e.isLastFrame()?e.setFirst():(e.setNext(),e.play())}),e.events.on("userInputStart",function(e){(0===e||e>100)&&(n.empty(),o.show(),e>100&&(t=Math.ceil(e/100),r()))}),e.events.on("userInputEnd",function(){o.hide(),a()})})}function GifiddleAutoplay(e){e.events.on("initPlayer",function(e){e.events.on("ready",function(){var t=e.getFrameCount();t>1&&e.play()})})}function GifiddleAutoload(e){var t=document.URL,o=t.indexOf("#");if(-1!==o){var n=t.substring(o+1);n.length>0&&e.loadUrl(n)}}function GifiddleDragAndDrop(e){var t=$(document);t.on("dragover",function(e){e.stopPropagation(),e.preventDefault()}),t.on("drop",function(t){t.stopPropagation(),t.preventDefault();var o=t.originalEvent.dataTransfer.files[0];o&&e.loadFile(o)})}function GifiddleInfo(e){function t(e,t,o){if(!t)return"n/a";var n=$("<div>");n.addClass("color-table");for(var i=0;i<e.length;i++){var r=e[i],a=$("<div>");a.css("background-color","rgb("+r.join()+")"),a.attr("title",i+": "+r.join()),n.append(a)}var l=$("<p>");l.append(e.length),o&&l.append(" sorted"),l.append(" colors");var d=$("<div>");return d.append(l),d.append(n),d}function o(e){var o=e.hdr;d.show(),p.empty(),p.row("Version",o.ver),p.row("Screen size",o.width+"x"+o.height),p.row("Global color table",t(o.gct,o.gctFlag,o.gctSortFlag)),p.row("Color resolution",x.colorRes(o.colorRes)),p.row("Background color",o.bgColor),p.row("Pixel aspect ratio",x.aspectRatio(o.pixelAspectRatio)),-1!==e.loopCount&&p.row("Loop count",e.loopCount)}function n(e){v.empty();var t=e.xmp;if(t&&t.startsWith("<?xpacket")){s.show();var o=new DOMParser,n=o.parseFromString(t,"text/xml"),i=n.getElementsByTagNameNS("adobe:ns:meta/","xmpmeta")[0];if(i){var r=i.getAttributeNS("adobe:ns:meta/","xmptk");r&&v.row("Toolkit",r)}for(var a=n.getElementsByTagNameNS("http://www.w3.org/1999/02/22-rdf-syntax-ns#","Description"),l=0;a&&l<a.length;l++){for(var d=a[l],c=0;c<d.attributes.length;c++){var u=d.attributes[c];u.name.startsWith("xmp:")&&v.row(u.localName,u.value)}for(var l=0;l<d.childNodes.length;l++){var f=d.childNodes[l];f.nodeName.startsWith("xmp:")&&v.row(f.localName,f.textContent)}}}else s.hide()}function i(e){function t(e){var t=1;return t=17*t+e[0],t=31*t+e[1],t=13*t+e[2]}h.show(),b.empty();var o=0,n=0,i=0,r=0,a=new Set,l=0;if(e.hdr.gctFlag&&(r+=e.hdr.gct.length,e.hdr.gct.forEach(function(e){a.add(t(e))})),e.frames.forEach(function(d){var s=d.img;if(s){o+=s.lzwSize,n+=s.width*s.height,i+=e.hdr.width*e.hdr.height,s.lctFlag&&(r+=s.lct.length,s.lct.forEach(function(e){a.add(t(e))}));var c=d.gce;c&&(l+=c.delayTime)}}),o>0&&(b.row("File size",x.byteSize(e.byteLength)),b.row("Absolute DCR",x.compressRatio(o,n)).attr("title","Combined data compression ratio of all frames.\nTypical GIFs have a ratio between 1 to 4 while\nsimple graphics with few colors compress much better."),b.row("Virtual DCR",x.compressRatio(o,i)).attr("title","Combined data compression ratio of all frames if they would\nfill up the entire GIF screen.\nHigh values (> 10) are typical for well-optimized GIFs,\nsuch as cinemagraphs.")),b.row("Total colors",r).attr("title","Total number of defined colors in the GIF.\nIncludes colors from local and global color tables."),b.row("Unique colors",a.size).attr("title","Total number of unique colors in the GIF.\nIncludes colors from local and global color tables."),l>0){var d=l/100;b.row("Total time",d.toFixed(2)+"s").attr("title","Sum of all frame delays, which defines the duration of a GIF."),b.row("Average bitrate",x.bitrate(o/d*8)).attr("title","If GIF was a video codec, this would be the average bitrate."),b.row("Average framerate",(e.frames.length/d).toFixed(2)+" fps").attr("title","If GIF was a video codec, this would be the average framerate.")}}function r(e,o){if(F=e,I=o,a.is(":visible")){m.empty();var n=e.img;n?(u.show(),m.row("Index",o),m.row("Size",n.width+"x"+n.height),m.row("Position",n.topPos+"x"+n.leftPos),m.row("Interlaced",x["boolean"](n.interlaced)),m.row(),m.col("Local color table"),T[o]||(T[o]=t(n.lct,n.lctFlag,n.lctSortFlag)),m.col(T[o]),m.row("Compressed size",x.byteSize(n.lzwSize)),m.row("Uncompressed size",x.byteSize(n.width*n.height)),m.row("Compression ratio",x.compressRatio(n.lzwSize,n.width*n.height)),m.row("LZW min. code size",n.lzwMinCodeSize)):u.hide(),g.empty();var i=e.pte;i?(f.show(),g.row("Index",o),g.row("Size",i.width+"x"+i.height),g.row("Position",i.topPos+"x"+i.leftPos),g.row("Character cell size",i.charCellWidth+"x"+i.charCellHeight),g.row("Foreground color",i.fgColor),g.row("Background color",i.bgColor)):f.hide(),w.empty();var r=e.gce;r?(c.show(),w.row("Delay",x.delayTime(r.delayTime)),w.row("Disposal method",x.disposalMethod(r.disposalMethod)),w.row("Transparent",x["boolean"](r.transparencyFlag)),w.row("Wait for user input",x["boolean"](r.userInput))):c.hide()}}var a=$("#info-sidebar"),l=a.find(".panel"),d=a.find("#info-panel-hdr"),s=a.find("#info-panel-xmp"),c=a.find("#info-panel-gce"),u=a.find("#info-panel-img"),f=a.find("#info-panel-pte"),h=a.find("#info-panel-stats"),p=new Table(d.find("table")),v=new Table(s.find("table")),w=new Table(c.find("table")),m=new Table(u.find("table")),g=new Table(f.find("table")),b=new Table(h.find("table")),y=$("#checkbox-show-info");y.on("change",function(e){e.target.checked?(a.fadeIn(),null!==F&&(r(F,I),F=null,I=null)):a.fadeOut()}),y.prop("checked")?a.fadeIn():a.fadeOut();var x={byteSize:function(e,t){var o=t?1e3:1024;if(o>e)return e+" B";var n=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=-1;do e/=o,++i;while(e>=o);return e.toFixed(2)+" "+n[i]},bitrate:function(e){var t=1e3;if(t>e)return e+" B";var o=["k","M","G","T","P","E","Z","Y"],n=-1;do e/=t,++n;while(e>=t);return e.toFixed(2)+" "+o[n]+"bit/s"},delayTime:function(e){var t=e+" (";return e*=10,t+=e>=1e3?(e/1e3).toFixed(2)+" s":e+" ms",t+=")"},disposalMethod:function(e){var t=e+" (",o=["unspecified","none","background","previous"];return t+=o[e]?o[e]:"undefined",t+=")"},"boolean":function(e){return e?"yes":"no"},aspectRatio:function(e){var t=e;return 0!==e&&(t+=" (",t+=((e+15)/64).toFixed(2),t+=")"),t},colorRes:function(e){var t=e;return e>0&&(t+=" (",t+=e-1,t+=" bpp)"),t},compressRatio:function(e,t){var o=t/e;return o.toFixed(2)}};l.hide();var F,I,T;e.events.on("initPlayer",function(e){F=null,T=[],e.events.on("ready",function(e){o(e),i(e),n(e)}),e.events.on("update",function(){r(e.getFrame(),e.getFrameIndex())}),e.events.on("destroy",function(){a.hide()})})}function Table(e){var t=e.find("tbody");0===t.length&&(t=$("<tbody>"),e.append(t));var o;return{row:function(){o=$("<tr>"),t.append(o);for(var e=0;e<arguments.length;e++)this.col(arguments[e]);return o},col:function(e){o||this.row();var t=$("<td>");return"string"==typeof e?t.text(e):t.append(e),o.append(t),t},empty:function(){t.empty()}}}function HttpStatus(e){this.code=e}HttpStatus.prototype.statusCodes={200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Unused",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Required",413:"Request Entry Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"},HttpStatus.prototype.toString=function(){return this.code+" "+this.statusCodes[this.code]};